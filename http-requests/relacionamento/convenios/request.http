### ==========================================
### CONVÊNIOS - REQUESTS COMPLETOS
### Arquivo unificado com todos os campos suportados
### ==========================================

### ==========================================
### AUTENTICAÇÃO
### ==========================================

### Login para obter token
# @name login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "diegosoek@gmail.com",
  "password": "Admin123!"
}

### Armazenar token (usar após login)
@token = {{login.response.body.access_token}}

### ==========================================
### CRIAR CONVÊNIO COMPLETO (PATCH)
### Primeiro crie a empresa tipo CONVENIO via /empresas
### Depois use este PATCH para preencher dados específicos
### ==========================================

### Atualizar convênio com TODOS os campos
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "nome": "Unimed São Paulo",
  "registro_ans": "359017",
  "matricula": "123456789",
  "tipo_convenio_id": null,
  "forma_liquidacao_id": null,
  "valor_ch": 100.50,
  "valor_filme": 50.00,
  "tiss": true,
  "versao_tiss": "3.05.00",
  "codigo_operadora_tiss": "123456",
  "codigo_operadora_autorizacao": "654321",
  "codigo_prestador": "789456",
  "envio_faturamento_id": null,
  "fatura_ate_dia": 25,
  "dia_vencimento": 10,
  "data_contrato": "2023-01-15",
  "data_ultimo_ajuste": "2024-01-15",
  "instrucoes_faturamento": "Enviar NF junto com a fatura até o dia 25 de cada mês",
  "tabela_servico_id": null,
  "tabela_base_id": null,
  "tabela_material_id": null,
  "cnes": "1234567",
  "co_participacao": true,
  "nota_fiscal_exige_fatura": true,
  "contato": "João Silva - Setor de Faturamento",
  "instrucoes": "Enviar resultados por email para faturamento@unimed.com.br",
  "observacoes_gerais": "Convênio prioritário - Atendimento preferencial",
  "integracao_id": null,
  "ativo": true
}

### ==========================================
### SEÇÃO: IDENTIFICAÇÃO
### ==========================================

### Atualizar apenas identificação
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "nome": "Unimed São Paulo",
  "registro_ans": "359017",
  "matricula": "123456789",
  "tipo_convenio_id": null,
  "forma_liquidacao_id": null
}

### ==========================================
### SEÇÃO: VALORES
### ==========================================

### Atualizar apenas valores
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "valor_ch": 100.50,
  "valor_filme": 50.00
}

### ==========================================
### SEÇÃO: TISS
### ==========================================

### Atualizar configurações TISS
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "tiss": true,
  "versao_tiss": "3.05.00",
  "codigo_operadora_tiss": "123456",
  "codigo_operadora_autorizacao": "654321",
  "codigo_prestador": "789456"
}

### Desativar TISS
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "tiss": false,
  "versao_tiss": null,
  "codigo_operadora_tiss": null,
  "codigo_operadora_autorizacao": null,
  "codigo_prestador": null
}

### ==========================================
### SEÇÃO: FATURAMENTO
### ==========================================

### Atualizar configurações de faturamento
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "envio_faturamento_id": null,
  "fatura_ate_dia": 25,
  "dia_vencimento": 10,
  "data_contrato": "2023-01-15",
  "data_ultimo_ajuste": "2024-01-15",
  "instrucoes_faturamento": "Enviar NF junto com a fatura até o dia 25 de cada mês"
}

### ==========================================
### SEÇÃO: TABELAS
### ==========================================

### Atualizar tabelas de preços
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "tabela_servico_id": null,
  "tabela_base_id": null,
  "tabela_material_id": null,
  "cnes": "1234567"
}

### ==========================================
### SEÇÃO: OUTRAS INFORMAÇÕES
### ==========================================

### Atualizar outras informações
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "co_participacao": true,
  "nota_fiscal_exige_fatura": true,
  "contato": "João Silva - Setor de Faturamento",
  "instrucoes": "Enviar resultados por email para faturamento@unimed.com.br",
  "observacoes_gerais": "Convênio prioritário - Atendimento preferencial"
}

### ==========================================
### SEÇÃO: INTEGRAÇÃO
### ==========================================

### Vincular integração ao convênio
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "integracao_id": "uuid-da-integracao"
}

### Remover vínculo de integração
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "integracao_id": null
}

### ==========================================
### CONSULTAS
### ==========================================

### Listar todos os convênios
GET {{baseUrl}}/relacionamento/convenios
Authorization: Bearer {{token}}

### Listar convênios ativos
GET {{baseUrl}}/relacionamento/convenios/ativos
Authorization: Bearer {{token}}

### Buscar convênio por ID
GET {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}

### Buscar convênio por CNPJ
GET {{baseUrl}}/relacionamento/convenios/cnpj/12345678000199
Authorization: Bearer {{token}}

### Buscar por termo (nome, razão social)
GET {{baseUrl}}/relacionamento/convenios/search?q=unimed
Authorization: Bearer {{token}}

### Obter estatísticas
GET {{baseUrl}}/relacionamento/convenios/estatisticas
Authorization: Bearer {{token}}

### ==========================================
### OPERAÇÕES
### ==========================================

### Alternar status ativo/inativo
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}/toggle-status
Authorization: Bearer {{token}}

### Deletar convênio (soft delete)
DELETE {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}

### ==========================================
### FLUXO COMPLETO DE CRIAÇÃO
### ==========================================

### PASSO 1: Criar empresa do tipo CONVENIO
### (A resposta retornará o ID que será usado como convenio_id)
POST {{baseUrl}}/empresas
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "tipoEmpresa": "CONVENIO",
  "cnpj": "12345678000199",
  "razaoSocial": "UNIMED SAO PAULO COOPERATIVA DE TRABALHO MEDICO",
  "nomeFantasia": "Unimed São Paulo",
  "inscricaoEstadual": "123456789",
  "inscricaoMunicipal": "987654321",
  "telefone": "(11) 3333-4444",
  "email": "contato@unimed.com.br",
  "website": "https://www.unimed.com.br",
  "cep": "01310-100",
  "logradouro": "Av. Paulista",
  "numero": "1000",
  "complemento": "10º andar",
  "bairro": "Bela Vista",
  "cidade": "São Paulo",
  "uf": "SP"
}

### PASSO 2: Atualizar dados específicos do convênio
### Use o ID retornado no passo 1 como {{convenio_id}}
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "nome": "Unimed São Paulo",
  "registro_ans": "359017",
  "matricula": "123456789",
  "valor_ch": 100.50,
  "valor_filme": 50.00,
  "tiss": true,
  "versao_tiss": "3.05.00",
  "codigo_operadora_tiss": "123456",
  "codigo_operadora_autorizacao": "654321",
  "codigo_prestador": "789456",
  "fatura_ate_dia": 25,
  "dia_vencimento": 10,
  "data_contrato": "2023-01-15",
  "instrucoes_faturamento": "Enviar NF junto com a fatura",
  "cnes": "1234567",
  "co_participacao": true,
  "nota_fiscal_exige_fatura": true,
  "contato": "João Silva",
  "instrucoes": "Enviar resultados por email",
  "observacoes_gerais": "Convênio prioritário",
  "ativo": true
}

### ==========================================
### EXEMPLOS DE CONVÊNIOS COMUNS
### ==========================================

### Exemplo: Unimed (com TISS)
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "nome": "Unimed",
  "registro_ans": "359017",
  "tiss": true,
  "versao_tiss": "3.05.00",
  "codigo_operadora_tiss": "359017",
  "codigo_prestador": "123456",
  "fatura_ate_dia": 25,
  "dia_vencimento": 15,
  "co_participacao": false,
  "nota_fiscal_exige_fatura": true,
  "ativo": true
}

### Exemplo: SulAmérica (com co-participação)
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "nome": "SulAmérica Saúde",
  "registro_ans": "006246",
  "tiss": true,
  "versao_tiss": "3.05.00",
  "codigo_operadora_tiss": "006246",
  "codigo_prestador": "789012",
  "fatura_ate_dia": 20,
  "dia_vencimento": 10,
  "co_participacao": true,
  "nota_fiscal_exige_fatura": true,
  "instrucoes": "Cobrança de coparticipação no ato do atendimento",
  "ativo": true
}

### Exemplo: Particular (sem TISS)
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "nome": "Particular",
  "tiss": false,
  "valor_ch": 150.00,
  "valor_filme": 80.00,
  "co_participacao": false,
  "nota_fiscal_exige_fatura": false,
  "instrucoes": "Pagamento à vista ou cartão",
  "ativo": true
}

### Exemplo: SUS
PATCH {{baseUrl}}/relacionamento/convenios/{{convenio_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "nome": "SUS - Sistema Único de Saúde",
  "tiss": false,
  "cnes": "1234567",
  "fatura_ate_dia": 5,
  "dia_vencimento": 30,
  "co_participacao": false,
  "nota_fiscal_exige_fatura": false,
  "instrucoes": "Seguir procedimentos do BPA/APAC",
  "ativo": true
}

### ==========================================
### VARIÁVEIS
### ==========================================
### Defina estas variáveis no seu ambiente ou no http-client.env.json:
###
### @baseUrl = http://localhost:10016/api/v1
### @token = <seu_token_jwt>
### @convenio_id = <uuid_do_convenio>
