### =====================================================
### CRIAR ITEM DA TABELA DE PREÇOS
### =====================================================

### Criar Item - Básico (apenas campos obrigatórios)
POST {{baseUrl}}/relacionamento/tabelas-preco/{{tabelaPrecoId}}/itens
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "exame_id": "{{exameId}}",
  "valor": 150.00
}

### Expected Response
# Status: 201 Created
# {
#   "id": "uuid",
#   "tabela_preco_id": "uuid",
#   "exame_id": "uuid",
#   "codigo_convenio": null,
#   "moeda": "BRL",
#   "quantidade_filme": 0,
#   "filme_separado": false,
#   "porte": 0,
#   "valor": 150.00,
#   "custo_operacional": null,
#   "ativo": true,
#   "created_at": "2025-11-29T...",
#   "updated_at": "2025-11-29T..."
# }

###

### Criar Item - Completo (todos os campos)
POST {{baseUrl}}/relacionamento/tabelas-preco/{{tabelaPrecoId}}/itens
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "exame_id": "{{exameId}}",
  "valor": 250.00,
  "codigo_convenio": "CON001",
  "moeda": "BRL",
  "quantidade_filme": 2.5,
  "filme_separado": true,
  "porte": 2,
  "custo_operacional": 80.00,
  "ativo": true
}

### Expected Response
# Status: 201 Created
# {
#   "id": "uuid",
#   "tabela_preco_id": "uuid",
#   "exame_id": "uuid",
#   "codigo_convenio": "CON001",
#   "moeda": "BRL",
#   "quantidade_filme": 2.5,
#   "filme_separado": true,
#   "porte": 2,
#   "valor": 250.00,
#   "custo_operacional": 80.00,
#   "ativo": true,
#   ...
# }

###

### Criar Múltiplos Itens (Batch)
POST {{baseUrl}}/relacionamento/tabelas-preco/{{tabelaPrecoId}}/itens/batch
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "itens": [
    {
      "exame_id": "{{exameId1}}",
      "valor": 100.00,
      "codigo_convenio": "EXA001"
    },
    {
      "exame_id": "{{exameId2}}",
      "valor": 200.00,
      "codigo_convenio": "EXA002"
    },
    {
      "exame_id": "{{exameId3}}",
      "valor": 300.00,
      "codigo_convenio": "EXA003"
    }
  ]
}

### Expected Response
# Status: 201 Created
# {
#   "created": 3,
#   "itens": [...]
# }

###

### =====================================================
### VALIDAÇÕES - Erros Esperados
### =====================================================

### Criar Item - Exame já existe na tabela
POST {{baseUrl}}/relacionamento/tabelas-preco/{{tabelaPrecoId}}/itens
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "exame_id": "{{exameIdExistente}}",
  "valor": 150.00
}

### Expected Response
# Status: 409 Conflict
# {
#   "statusCode": 409,
#   "message": "Este exame já está cadastrado nesta tabela de preços"
# }

###

### Criar Item - Exame não encontrado
POST {{baseUrl}}/relacionamento/tabelas-preco/{{tabelaPrecoId}}/itens
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "exame_id": "00000000-0000-0000-0000-000000000000",
  "valor": 150.00
}

### Expected Response
# Status: 404 Not Found
# {
#   "statusCode": 404,
#   "message": "Exame não encontrado"
# }

###

### Criar Item - Tabela não encontrada
POST {{baseUrl}}/relacionamento/tabelas-preco/00000000-0000-0000-0000-000000000000/itens
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "exame_id": "{{exameId}}",
  "valor": 150.00
}

### Expected Response
# Status: 404 Not Found
# {
#   "statusCode": 404,
#   "message": "Tabela de preços não encontrada"
# }

###

### Criar Item - Campo obrigatório faltando (exame_id)
POST {{baseUrl}}/relacionamento/tabelas-preco/{{tabelaPrecoId}}/itens
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "valor": 150.00
}

### Expected Response
# Status: 400 Bad Request
# {
#   "statusCode": 400,
#   "message": ["ID do exame é obrigatório"]
# }

###

### Criar Item - Campo obrigatório faltando (valor)
POST {{baseUrl}}/relacionamento/tabelas-preco/{{tabelaPrecoId}}/itens
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "exame_id": "{{exameId}}"
}

### Expected Response
# Status: 400 Bad Request
# {
#   "statusCode": 400,
#   "message": ["Valor é obrigatório"]
# }

###

### Criar Item - Valor negativo
POST {{baseUrl}}/relacionamento/tabelas-preco/{{tabelaPrecoId}}/itens
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "exame_id": "{{exameId}}",
  "valor": -50.00
}

### Expected Response
# Status: 400 Bad Request
# {
#   "statusCode": 400,
#   "message": ["Valor não pode ser negativo"]
# }

###

### Criar Item Sem Autenticação
POST {{baseUrl}}/relacionamento/tabelas-preco/{{tabelaPrecoId}}/itens
Content-Type: {{contentType}}

{
  "exame_id": "{{exameId}}",
  "valor": 150.00
}

### Expected Response
# Status: 401 Unauthorized
# {
#   "statusCode": 401,
#   "message": "Unauthorized"
# }
