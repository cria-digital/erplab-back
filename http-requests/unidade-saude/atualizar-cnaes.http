### ===================================
### ATUALIZAÇÃO DE CNAEs DAS UNIDADES
### ===================================
### IMPORTANTE: Os CNAEs devem ser IDs válidos da tabela 'cnaes'
### Para buscar CNAEs disponíveis:
### - Listar todos: GET {{baseUrl}}/cnae
### - Buscar por termo: GET {{baseUrl}}/cnae/search?q=laboratorio
### - Por divisão (ex: 86 = Saúde): GET {{baseUrl}}/cnae/divisao/86
###
### CNAEs comuns da área de saúde:
### - 86402: Atividades de serviços de complementação diagnóstica e terapêutica (Laboratórios)
### - 86101: Atividades de atendimento hospitalar
### - 86305: Atividades de atenção ambulatorial executadas por médicos e odontólogos
### - 86500: Atividades de profissionais da área de saúde, exceto médicos e odontólogos
### ===================================

### Atualizar apenas CNAE Principal
# Substitua {id} pelo UUID real da unidade
PATCH {{baseUrl}}/unidades-saude/c31fc71a-ce64-4c4e-98ee-a7bd094705d5
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "cnaePrincipalId": "077431ba-a2ac-4f3f-88f6-2a1bdb1322e1"
}

### Expected Response
# Status: 200 OK
# {
#   "id": "c31fc71a-ce64-4c4e-98ee-a7bd094705d5",
#   "cnaePrincipalId": "077431ba-a2ac-4f3f-88f6-2a1bdb1322e1",
#   "cnaePrincipal": {
#     "id": "077431ba-a2ac-4f3f-88f6-2a1bdb1322e1",
#     "codigo": "86402",
#     "descricao": "ATIVIDADES DE SERVIÇOS DE COMPLEMENTAÇÃO DIAGNÓSTICA E TERAPÊUTICA"
#   },
#   ...
# }

###

### Atualizar CNAEs Secundários (Substituir todos)
# Este endpoint substitui TODOS os CNAEs secundários existentes
PATCH {{baseUrl}}/unidades-saude/c31fc71a-ce64-4c4e-98ee-a7bd094705d5
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "cnaeSecundarios": [
    {
      "cnaeId": "7aa74aae-ec54-4db0-9267-eb67b9d2df88"
    },
    {
      "cnaeId": "854cc928-7ae0-42b4-b123-7395ceaa0fba"
    },
    {
      "cnaeId": "faaefa9f-7962-4f15-a21c-0c69ba9254a6"
    }
  ]
}

### Expected Response
# Status: 200 OK
# {
#   "id": "c31fc71a-ce64-4c4e-98ee-a7bd094705d5",
#   "cnaeSecundarios": [
#     {
#       "id": "uuid-gerado",
#       "cnaeId": "7aa74aae-ec54-4db0-9267-eb67b9d2df88",
#       "cnae": {
#         "codigo": "86101",
#         "descricao": "ATIVIDADES DE ATENDIMENTO HOSPITALAR"
#       }
#     },
#     {
#       "id": "uuid-gerado",
#       "cnaeId": "854cc928-7ae0-42b4-b123-7395ceaa0fba",
#       "cnae": {
#         "codigo": "86305",
#         "descricao": "ATIVIDADES DE ATENÇÃO AMBULATORIAL..."
#       }
#     }
#   ],
#   ...
# }

###

### Atualizar CNAE Principal e Secundários ao mesmo tempo
PATCH {{baseUrl}}/unidades-saude/c31fc71a-ce64-4c4e-98ee-a7bd094705d5
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "cnaePrincipalId": "077431ba-a2ac-4f3f-88f6-2a1bdb1322e1",
  "cnaeSecundarios": [
    {
      "cnaeId": "7aa74aae-ec54-4db0-9267-eb67b9d2df88"
    },
    {
      "cnaeId": "11b7559a-dcdf-48f6-8bef-0e9e9a2c2f11"
    }
  ]
}

###

### Remover todos os CNAEs Secundários (enviar array vazio)
PATCH {{baseUrl}}/unidades-saude/c31fc71a-ce64-4c4e-98ee-a7bd094705d5
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "cnaeSecundarios": []
}

### Expected Response
# Status: 200 OK
# {
#   "id": "c31fc71a-ce64-4c4e-98ee-a7bd094705d5",
#   "cnaeSecundarios": [],
#   ...
# }

###

### Remover CNAE Principal (enviar null)
PATCH {{baseUrl}}/unidades-saude/c31fc71a-ce64-4c4e-98ee-a7bd094705d5
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "cnaePrincipalId": null
}

### Expected Response
# Status: 200 OK
# {
#   "id": "c31fc71a-ce64-4c4e-98ee-a7bd094705d5",
#   "cnaePrincipalId": null,
#   "cnaePrincipal": null,
#   ...
# }

###

### EXEMPLO COMPLETO: Configurar CNAEs para um Laboratório de Análises Clínicas
PATCH {{baseUrl}}/unidades-saude/c31fc71a-ce64-4c4e-98ee-a7bd094705d5
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "cnaePrincipalId": "077431ba-a2ac-4f3f-88f6-2a1bdb1322e1",
  "cnaeSecundarios": [
    {
      "cnaeId": "854cc928-7ae0-42b4-b123-7395ceaa0fba"
    },
    {
      "cnaeId": "faaefa9f-7962-4f15-a21c-0c69ba9254a6"
    }
  ],
  "nomeFantasia": "Laboratório de Análises Clínicas São Roque"
}

### Expected Response
# Status: 200 OK
# Unidade atualizada com:
# - CNAE Principal: 86402 (Laboratório)
# - CNAE Secundário 1: 86305 (Atividades ambulatoriais)
# - CNAE Secundário 2: 86500 (Profissionais da saúde)

###

### ERRO: Tentar usar CNAE inexistente
PATCH {{baseUrl}}/unidades-saude/c31fc71a-ce64-4c4e-98ee-a7bd094705d5
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "cnaePrincipalId": "99999999-9999-9999-9999-999999999999"
}

### Expected Response
# Status: 400 Bad Request
# {
#   "statusCode": 400,
#   "message": "CNAE não encontrado",
#   "error": "Bad Request"
# }

###

### Buscar CNAEs disponíveis para laboratórios (86402)
GET {{baseUrl}}/cnae/codigo?codigo=86402

### Expected Response
# Status: 200 OK
# {
#   "id": "077431ba-a2ac-4f3f-88f6-2a1bdb1322e1",
#   "codigo": "86402",
#   "descricao": "ATIVIDADES DE SERVIÇOS DE COMPLEMENTAÇÃO DIAGNÓSTICA E TERAPÊUTICA",
#   "secao": "Q",
#   "divisao": "86",
#   "grupo": "864",
#   "classe": "8640",
#   "subclasse": "86402"
# }