### Atualizar imobilizado completo
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "descricao": "Edificio Sede - Laboratorio Clinico (Reformado)",
  "subcategoria": "Edificio Comercial Reformado",
  "setorResponsavel": "Administracao Geral",
  "localizacao": "Rua das Flores, 1234 - Centro - Sao Paulo/SP",
  "responsavel": "Dr. Carlos Silva - Diretor Geral",
  "observacoes": "Edificio de 3 andares com 1.200m2 de area construida. Reforma concluida em 2024 incluindo atualizacao de instalacoes eletricas e hidraulicas. Registro de Imoveis n° 12345. Matricula 67890.",
  "documentos": [
    "https://storage.lab.com/documentos/escritura-imovel-001.pdf",
    "https://storage.lab.com/documentos/registro-imovel-001.pdf",
    "https://storage.lab.com/documentos/iptu-imovel-001.pdf",
    "https://storage.lab.com/documentos/laudo-reforma-2024.pdf"
  ]
}

### Expected Response
# Status: 200 OK
# {
#   "id": "550e8400-e29b-41d4-a716-446655440000",
#   "codigoPatrimonio": "IMOB-2024-001",
#   "descricao": "Edificio Sede - Laboratorio Clinico (Reformado)",
#   "status": "ativo",
#   "updatedAt": "2025-10-09T15:30:00.000Z"
# }

###

### Atualizar apenas localizacao
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "localizacao": "Datacenter - Rack A5 - Posicao 12U",
  "observacoes": "Servidor realocado para novo rack apos expansao do datacenter"
}

###

### Atualizar responsavel
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "responsavel": "Dr. Paulo Santos - Novo Coordenador TI",
  "observacoes": "Mudanca de responsavel apos promocao"
}

###

### Atualizar setor responsavel
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "setorResponsavel": "Radiologia Digital",
  "localizacao": "Sala de Laudos - 2° Andar",
  "responsavel": "Dr. Fernando Costa",
  "observacoes": "Workstation transferida para setor de Radiologia Digital"
}

###

### Atualizar status - Colocar em manutencao
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "status": "manutencao",
  "observacoes": "Veiculo em manutencao preventiva - revisao de 50.000km. Previsao de retorno: 3 dias uteis"
}

###

### Atualizar status - Retornar de manutencao
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "status": "ativo",
  "observacoes": "Manutencao preventiva concluida. Veiculo aprovado e liberado para uso. Proxima revisao: 60.000km"
}

###

### Dar baixa em imobilizado
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "status": "baixa",
  "dataBaixa": "2024-10-15",
  "motivoBaixa": "Obsolescencia tecnologica - Substituido por modelo mais moderno e eficiente",
  "observacoes": "Equipamento doado para instituicao de ensino. Termo de doacao n° 2024-045"
}

###

### Alienar imobilizado
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "status": "alienado",
  "dataBaixa": "2024-09-30",
  "motivoBaixa": "Venda para terceiros - Atualizacao de frota",
  "observacoes": "Veiculo vendido conforme avaliacao de mercado. Contrato de venda n° 2024-CV-087. Valor de venda: R$ 95.000,00"
}

###

### Atualizar apenas observacoes
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "observacoes": "Equipamento em perfeito estado de funcionamento. Ultima manutencao preventiva realizada em 15/09/2024. Proxima manutencao agendada para 15/03/2025. Responsavel tecnico: Eng. Roberto Lima CREA-SP 456789"
}

###

### Adicionar documentos ao imobilizado
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "documentos": [
    "https://storage.lab.com/documentos/nota-fiscal-original.pdf",
    "https://storage.lab.com/documentos/garantia-fabricante.pdf",
    "https://storage.lab.com/documentos/manual-usuario.pdf",
    "https://storage.lab.com/documentos/certificado-calibracao-2024.pdf",
    "https://storage.lab.com/documentos/laudo-tecnico-instalacao.pdf"
  ]
}

###

### Atualizar subcategoria
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "subcategoria": "Servidor de Alta Performance",
  "observacoes": "Reclassificado apos upgrade de hardware"
}

###

### Atualizar fornecedor
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "fornecedorId": "{{novoFornecedorId}}",
  "observacoes": "Fornecedor atualizado para novo representante autorizado"
}

###

### Remover subcategoria (tornar nula)
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "subcategoria": null,
  "observacoes": "Subcategoria removida - classificacao simplificada"
}

###

### Atualizar vida util (recalcula depreciacao)
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "vidaUtilAnos": 7,
  "observacoes": "Vida util ajustada apos avaliacao tecnica. Nova taxa de depreciacao sera recalculada automaticamente"
}

###

### Atualizar valor residual
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "valorResidual": 15000.00,
  "observacoes": "Valor residual ajustado conforme nova avaliacao de mercado"
}

###

### Alterar metodo de depreciacao
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "metodoDepreciacao": "soma_digitos",
  "observacoes": "Metodo de depreciacao alterado para soma de digitos conforme aprovacao contabil. Recalculo automatico a partir da proxima competencia"
}

###

### Transferir para novo setor com mudanca de responsavel
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "setorResponsavel": "Ultrassonografia",
  "localizacao": "Sala de Ultrassom 2 - 3° Andar",
  "responsavel": "Dra. Mariana Oliveira",
  "observacoes": "Equipamento transferido para novo setor apos expansao do servico de ultrassonografia. Termo de transferencia n° 2024-TRF-123"
}

###

### Atualizar nota fiscal
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "notaFiscal": "NF-CORRIGIDA-2024-0045",
  "observacoes": "Numero de nota fiscal corrigido conforme carta de correcao eletronica CCe"
}

###

### Tentar atualizar codigo patrimonio duplicado (deve dar erro)
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "codigoPatrimonio": "VEI-2024-002"
}

### Expected Response (se codigo ja existir)
# Status: 400 Bad Request
# {
#   "statusCode": 400,
#   "message": "Ja existe um imobilizado com o codigo patrimonio VEI-2024-002",
#   "error": "Bad Request"
# }

###

### Tentar atualizar placa duplicada (deve dar erro)
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "placa": "XYZ-5678"
}

### Expected Response (se placa ja existir)
# Status: 400 Bad Request
# {
#   "statusCode": 400,
#   "message": "Ja existe um imobilizado com a placa XYZ-5678",
#   "error": "Bad Request"
# }

###

### Tentar atualizar imobilizado inexistente (deve retornar 404)
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/00000000-0000-0000-0000-000000000000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "descricao": "Teste"
}

### Expected Response
# Status: 404 Not Found
# {
#   "statusCode": 404,
#   "message": "Imobilizado com ID 00000000-0000-0000-0000-000000000000 nao encontrado",
#   "error": "Not Found"
# }

###

### Tentar dar baixa sem data (deve dar erro)
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "status": "baixa",
  "motivoBaixa": "Obsolescencia"
}

### Expected Response
# Status: 400 Bad Request
# {
#   "statusCode": 400,
#   "message": "Data de baixa e obrigatoria quando status e 'baixa' ou 'alienado'",
#   "error": "Bad Request"
# }

###

### Tentar dar baixa sem motivo (deve dar erro)
PATCH {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "status": "baixa",
  "dataBaixa": "2024-10-15"
}

### Expected Response
# Status: 400 Bad Request
# {
#   "statusCode": 400,
#   "message": "Motivo de baixa e obrigatorio quando status e 'baixa' ou 'alienado'",
#   "error": "Bad Request"
# }

###

### Registrar movimentacao de imobilizado
POST {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000/movimentacoes
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "tipo": "transferencia_setor",
  "data": "2024-10-20",
  "setorOrigem": "TI - Geral",
  "setorDestino": "TI - Datacenter",
  "localizacaoOrigem": "Sala 305",
  "localizacaoDestino": "Datacenter - Rack A5",
  "responsavelMovimentacao": "Coord. TI - Roberto Lima",
  "observacoes": "Transferencia realizada apos upgrade de hardware. Equipamento agora classificado como servidor principal"
}

###

### Adicionar documento adicional
POST {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000/documentos
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "tipo": "certificado_calibracao",
  "url": "https://storage.lab.com/documentos/certificado-calibracao-2024-Q4.pdf",
  "descricao": "Certificado de calibracao trimestral - 4° Trimestre 2024",
  "dataDocumento": "2024-10-15"
}

###

### Recalcular depreciacao (forcar recalculo)
POST {{baseUrl}}/configuracoes/estrutura/imobilizados/550e8400-e29b-41d4-a716-446655440000/depreciacao/recalcular
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

### Expected Response
# Status: 200 OK
# {
#   "imobilizadoId": "uuid",
#   "codigoPatrimonio": "TI-2024-005",
#   "taxaDepreciacao": 20.00,
#   "valorDepreciadoAcumulado": 25500.00,
#   "valorContabil": 59500.00,
#   "dataRecalculo": "2024-10-20T10:30:00.000Z"
# }

###
